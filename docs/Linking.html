<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Linking Couchbase Data Source · Couchbase Plugin</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="[Purpose](#purpose)"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Linking Couchbase Data Source · Couchbase Plugin"/><meta property="og:type" content="website"/><meta property="og:url" content="https://delphix.github.io/couchbase-plugin/"/><meta property="og:description" content="[Purpose](#purpose)"/><meta property="og:image" content="https://delphix.github.io/couchbase-plugin/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/couchbase-plugin//img/logo.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/couchbase-plugin/js/scrollSpy.js"></script><link rel="stylesheet" href="/couchbase-plugin/css/main.css"/><script src="/couchbase-plugin/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/couchbase-plugin/"><img class="logo" src="/couchbase-plugin//img/delphix-logo-white.png" alt="Couchbase Plugin"/><h2 class="headerTitleWithLogo">Couchbase Plugin</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/couchbase-plugin/docs/Overview" target="_self">Docs</a></li><li class=""><a href="/couchbase-plugin/help" target="_self">Help</a></li><li class=""><a target="_self"></a></li><li class=""><a href="https://github.com/delphix/couchbase-plugin" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Linking</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Overview<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/couchbase-plugin/docs/Overview">Couchbase-plugin Overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">InstallPlugin<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/couchbase-plugin/docs/InstallPlugin">Install Couchbase Plugin</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">BuildPlugin<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/couchbase-plugin/docs/BuildPlugin">Plugin Development</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Discovery<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/couchbase-plugin/docs/Discovery">Discovery operation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Linking<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem navListItemActive"><a class="navItem" href="/couchbase-plugin/docs/Linking">Linking Couchbase Data Source</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Provisioning<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/couchbase-plugin/docs/Provisioning">Provision VDB</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Linking Couchbase Data Source</h1></header><article><div><span><p><a href="#purpose">Purpose</a></p>
<p><a href="#prerequisites">Prerequisites</a></p>
<p><a href="#create-dsource">Create dSource</a></p>
<p><a href="#xdcr-method">XDCR Method</a></p>
<p><a href="#couchbase-backup-manager-method">Couchbase Backup Manager Method</a></p>
<h1><a class="anchor" aria-hidden="true" id="purpose"></a><a href="#purpose" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Purpose</h1>
<p>Linking a data source will create a dSource object on the engine and allow Delphix to ingest data from this source. The dSource is an object that the Delphix Virtualization Engine uses to create and update virtual copies of your database.</p>
<h1><a class="anchor" aria-hidden="true" id="prerequisites"></a><a href="#prerequisites" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prerequisites</h1>
<ul>
<li>Discovery and source config object should be created on staging host before proceeding to link couchbase dataset</li>
</ul>
<h1><a class="anchor" aria-hidden="true" id="create-dsource"></a><a href="#create-dsource" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create dSource</h1>
<p>Steps:</p>
<ol>
<li>Login to Delphix Management application.</li>
<li>Click Manage &gt;  Datasets</li>
<li>Select Add dSource.</li>
<li>In the Add dSource wizard, select the couchbase source config you just created on the staging host.</li>
<li>Enter the Couchbase-specific parameters for your dSource configuration.</li>
<li>Select the dSource type from the drop-down available on dSource wizard.</li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="xdcr-method"></a><a href="#xdcr-method" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>XDCR Method</h2>
<p>Cross data center replication allows data to be replicated across clusters that are potentially located in different data centers.</p>
<ol>
<li>Enter the details for &quot;Staging Couchbase host&quot; - FQDN or IP address recommended</li>
<li>Enter the details for &quot;Staging Port Number&quot; available on staging host. The default port for couchbase is 8091.</li>
<li>Enter the details for &quot;Mount Path&quot; available on staging host. This empty folder acts as a base for NFS mounts.</li>
<li>Enter the details for &quot;Staging Cluster Name&quot; you would like Delphix to setup on your staging host.</li>
<li>Enter the configuration details for your staging cluster as per resource availability on the staging host.</li>
</ol>
<ul>
<li>Cluster RAM Size</li>
<li>Cluster Index RAM Size</li>
<li>Cluster FTS RAM Size</li>
<li>Cluster Eventing RAM Size</li>
<li>Cluster Analysis RAM Size</li>
</ul>
<p><img src="/couchbase-plugin/img/image12.png" alt=""></p>
<p><img src="/couchbase-plugin/img/image13.png" alt=""></p>
<ol start="6">
<li>Click on (+) plus symbol to modify configuration settings. This option allows to include bucket lists which should be part of couchbase cross data center replication (XDCR).</li>
</ol>
<p><img src="/couchbase-plugin/img/image14.png" alt=""></p>
<ol start="7">
<li>Enter the details of Bucket Name to be part of XDCR.</li>
</ol>
<p><img src="/couchbase-plugin/img/image15.png" alt=""></p>
<ol start="8">
<li>Provide the details for &quot;dSource Name&quot; and &quot;Target group&quot; on the dSource configuration page.</li>
</ol>
<p><img src="/couchbase-plugin/img/image16.png" alt=""></p>
<ol start="9">
<li>On the data management page, select the following:</li>
</ol>
<ul>
<li>Staging Environment: This will be your staging host where source config was created.</li>
<li>User: Database OS user with required privileges for linking the dataset.</li>
</ul>
<ol start="10">
<li><p>On the next section, review the configuration and click on next button to review the final summary.</p></li>
<li><p>Click the submit button which will initiate the linking process.</p></li>
</ol>
<p><img src="/couchbase-plugin/img/image17.png" alt=""></p>
<ol start="12">
<li>Once dSource is created successfully, you can review the datasets on Manage &gt; Datasets &gt; dSource Name.</li>
</ol>
<p><img src="/couchbase-plugin/img/image19.png" alt=""></p>
<ol start="13">
<li>Review the datasets on Manage &gt; Environment &gt; Database section.</li>
</ol>
<p><img src="/couchbase-plugin/img/image18.png" alt=""></p>
<h2><a class="anchor" aria-hidden="true" id="couchbase-backup-manager-method"></a><a href="#couchbase-backup-manager-method" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Couchbase Backup Manager Method</h2>
<p>Follow below instructions before going to create dsource to avoid source/production server dependency.</p>
<ul>
<li><p>Provide source server buckets related information in a file and place at <code>/tmp/couchbase_src_bucket_info.cfg</code>
<code>/opt/couchbase/bin/couchbase-cli bucket-list --cluster &lt;sourcehost&gt;:8091 --username $username --password $password</code></p></li>
<li><p>Backup Repository: This file will be required at the time of dSource creation using CBBACKUPMGR.
<code>/opt/couchbase/bin/cbbackupmgr config --archive /u01/couchbase_backup --repo delphix</code></p></li>
<li><p>Backup Location: Get data from source host in backup directory of staging host
<code>/opt/couchbase/bin/cbbackupmgr backup -a /u01/couchbase_backup -r delphix -c couchbase://&lt;hostname&gt; -u user -p password</code></p></li>
</ul>
<p>Steps:</p>
<ol>
<li>Login to Delphix Management application.</li>
<li>Click Manage &gt;  Datasets</li>
<li>Select Add dSource.</li>
<li>In the Add dSource wizard, select the couchbase source config you just created on the staging host.</li>
<li>Enter the Couchbase-specific parameters for your dSource configuration.</li>
<li>Select the dSource type from the drop-down available on dSource wizard.</li>
</ol>
<ul>
<li>Couchbase Backup Manager: Cbbackupmgr allows data to be restored on staging host of Couchbase Server.</li>
</ul>
<ol start="7">
<li>When we select CBbackupmgr as dSource Type, the following fields on dSource wizard are mandatory.</li>
<li>Enter the details for &quot;Backup Location&quot; where the backup files generated through cbbackupmgr are present on the staging host.</li>
<li>Enter the details for &quot;Backup Repository&quot; that contains a backup configuration of staging host. Details on how how to setup backup repository are listed here.</li>
</ol>
<p>Note: When we select dSource Type as Couchbase Backup Manager, we do not require any details for <code>Staging Couchbase Host</code> field.</p>
<ol start="10">
<li>Remaining steps for cbbackupmgr ingestion are similar to XDCR.</li>
</ol>
<p><img src="/couchbase-plugin/img/image22.png" alt="">
<img src="/couchbase-plugin/img/image23.png" alt=""></p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 6/19/2020</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/couchbase-plugin/docs/Discovery"><span class="arrow-prev">← </span><span>Discovery operation</span></a><a class="docs-next button" href="/couchbase-plugin/docs/Provisioning"><span>Provision VDB</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#xdcr-method">XDCR Method</a></li><li><a href="#couchbase-backup-manager-method">Couchbase Backup Manager Method</a></li></ul></nav></div></div></body></html>