



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="./image/logo.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-2.9.2">
    
    
      
        <title>Linking - Couchbase Plugin</title>
      
    
    
      <link rel="stylesheet" href="./assets/stylesheets/application.fbb7f3af.css">
      
      
    
    
      <script src="./assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Helvetica+Neue:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Helvetica Neue","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="./assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#purpose" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="" title="Couchbase Plugin" class="md-header-nav__button md-logo">
          
            <img src="./image/delphix-logo-white.png" width="153" height="15">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Couchbase Plugin
              </span>
              <span class="md-header-nav__topic">
                Linking
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/delphix/couchbase-plugin/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Github
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <img src="./image/delphix-logo-white.png" width="48" height="48">
      
    </span>
    Couchbase Plugin
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/delphix/couchbase-plugin/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Github
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="index.html" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="Discovery.html" title="Discovery" class="md-nav__link">
      Discovery
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="Installation.html" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="Linking.html" title="Linking" class="md-nav__link md-nav__link--active">
      Linking
    </a>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="PluginDevelopment.html" title="PluginDevelopment" class="md-nav__link">
      PluginDevelopment
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="Provisioning.html" title="Provisioning" class="md-nav__link">
      Provisioning
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/delphix/couchbase-plugin/edit/master/docs/Linking.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><a href="#purpose">Purpose</a></p>
<p><a href="#prerequisites">Prerequisites</a></p>
<p><a href="#create-dsource">Create dSource</a></p>
<p><a href="#xdcr-method">XDCR Method</a></p>
<p><a href="#couchbase-backup-manager-method">Couchbase Backup Manager Method</a></p>
<h1 id="purpose">Purpose<a class="headerlink" href="#purpose" title="Permanent link">&para;</a></h1>
<p>Linking a data source will create a dSource object on the engine and allow Delphix to ingest data from this source. The dSource is an object that the Delphix Virtualization Engine uses to create and update virtual copies of your database. </p>
<h1 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h1>
<ul>
<li>Discovery and source config object should be created on staging host before proceeding to link couchbase dataset </li>
</ul>
<h1 id="create-dsource">Create dSource<a class="headerlink" href="#create-dsource" title="Permanent link">&para;</a></h1>
<p>Steps:</p>
<ol>
<li>Login to Delphix Management application.</li>
<li>Click Manage &gt;  Datasets</li>
<li>Select Add dSource.</li>
<li>In the Add dSource wizard, select the couchbase source config you just created on the staging host.</li>
<li>Enter the Couchbase-specific parameters for your dSource configuration.</li>
<li>Select the dSource type from the drop-down available on dSource wizard.</li>
</ol>
<h2 id="xdcr-method">XDCR Method<a class="headerlink" href="#xdcr-method" title="Permanent link">&para;</a></h2>
<p>Cross data center replication allows data to be replicated across clusters that are potentially located in different data centers.</p>
<ol>
<li>Enter the details for "Staging Couchbase host" - FQDN or IP address recommended</li>
<li>Enter the details for "Staging Port Number" available on staging host. The default port for couchbase is 8091.</li>
<li>Enter the details for "Mount Path" available on staging host. This empty folder acts as a base for NFS mounts.</li>
<li>Enter the details for "Staging Cluster Name" you would like Delphix to setup on your staging host.</li>
<li>Enter the configuration details for your staging cluster as per resource availability on the staging host.</li>
<li>Cluster RAM Size</li>
<li>Cluster Index RAM Size</li>
<li>Cluster FTS RAM Size</li>
<li>Cluster Eventing RAM Size</li>
<li>Cluster Analysis RAM Size</li>
</ol>
<p><img alt="Screenshot" src="/couchbase-plugin/image/image12.png" /></p>
<p><img alt="Screenshot" src="/couchbase-plugin/couchbase-plugin/image/image13.png" /></p>
<ol>
<li>Click on (+) plus symbol to modify configuration settings. This option allows to include bucket lists which should be part of couchbase cross data center replication (XDCR).</li>
</ol>
<p><img alt="Screenshot" src="/couchbase-plugin/image/image14.png" /></p>
<ol>
<li>Enter the details of Bucket Name to be part of XDCR.</li>
</ol>
<p><img alt="Screenshot" src="/couchbase-plugin/image/image15.png" /></p>
<ol>
<li>Provide the details for "dSource Name" and "Target group" on the dSource configuration page.</li>
</ol>
<p><img alt="Screenshot" src="/couchbase-plugin/image/image16.png" /></p>
<ol>
<li>On the data management page, select the following:</li>
<li>Staging Environment: This will be your staging host where source config was created.</li>
<li>
<p>User: Database OS user with required privileges for linking the dataset.</p>
</li>
<li>
<p>On the next section, review the configuration and click on next button to review the final summary.</p>
</li>
<li>
<p>Click the submit button which will initiate the linking process.</p>
</li>
</ol>
<p><img alt="Screenshot" src="/couchbase-plugin/image/image17.png" /></p>
<ol>
<li>Once dSource is created successfully, you can review the datasets on Manage &gt; Datasets &gt; dSource Name.</li>
</ol>
<p><img alt="Screenshot" src="/couchbase-plugin/image/image19.png" /></p>
<ol>
<li>Review the datasets on Manage &gt; Environment &gt; Database section.</li>
</ol>
<p><img alt="Screenshot" src="/couchbase-plugin/image/image18.png" /></p>
<h2 id="couchbase-backup-manager-method">Couchbase Backup Manager Method<a class="headerlink" href="#couchbase-backup-manager-method" title="Permanent link">&para;</a></h2>
<p>Follow below instructions before going to create dsource to avoid source/production server dependency.
- Provide source server buckets related information in a file and place at <code>/tmp/couchbase_src_bucket_info.cfg</code>
  <code>/opt/couchbase/bin/couchbase-cli bucket-list --cluster &lt;sourcehost&gt;:8091 --username $username --password $password</code></p>
<ul>
<li>
<p>Backup Repository: This file will be required at the time of dSource creation using CBBACKUPMGR.
  <code>/opt/couchbase/bin/cbbackupmgr config --archive /u01/couchbase_backup --repo delphix</code></p>
</li>
<li>
<p>Backup Location: Get data from source host in backup directory of staging host
<code>/opt/couchbase/bin/cbbackupmgr backup -a /u01/couchbase_backup -r delphix -c couchbase://&lt;hostname&gt; -u user -p password</code></p>
</li>
</ul>
<p>Steps:</p>
<ol>
<li>Login to Delphix Management application.</li>
<li>Click Manage &gt;  Datasets</li>
<li>Select Add dSource.</li>
<li>In the Add dSource wizard, select the couchbase source config you just created on the staging host.</li>
<li>Enter the Couchbase-specific parameters for your dSource configuration.</li>
<li>Select the dSource type from the drop-down available on dSource wizard.</li>
<li>Couchbase Backup Manager: Cbbackupmgr allows data to be restored on staging host of Couchbase Server.</li>
<li>When we select CBbackupmgr as dSource Type, the following fields on dSource wizard are mandatory.</li>
<li>Enter the details for "Backup Location" where the backup files generated through cbbackupmgr are present on the staging host.</li>
<li>Enter the details for "Backup Repository" that contains a backup configuration of staging host. Details on how how to setup backup repository are listed here.</li>
</ol>
<p>Note: When we select dSource Type as Couchbase Backup Manager, we do not require any details for <code>Staging Couchbase Host</code> field.
10. Remaining steps for cbbackupmgr ingestion are similar to XDCR.</p>
<p><img alt="Screenshot" src="/couchbase-plugin/image/image22.png" />
<img alt="Screenshot" src="/couchbase-plugin/image/image23.png" /></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="Installation.html" title="Installation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Installation
              </span>
            </div>
          </a>
        
        
          <a href="PluginDevelopment.html" title="PluginDevelopment" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                PluginDevelopment
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 Delphix Corp.
          </div>
        
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="./assets/fonts/font-awesome.css">
    
      <a href="https://www.delphix.com/" class="md-footer-social__link fa fa-sitemap"></a>
    
      <a href="https://www.facebook.com/DelphixCorp/" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://twitter.com/delphix" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://www.linkedin.com/company/delphix" class="md-footer-social__link fa fa-linkedin"></a>
    
      <a href="https://github.com/delphix" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="./assets/javascripts/application.878fdd8d.js"></script>
      
      <script>app.initialize({version:"1.1.2",url:{base:"."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-35429885-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>